# 营养顾问技能设计

## 概述
**技能名称**: `nutrition-advisor`
**目的**: 提供个性化营养分析、膳食规划和饮食建议，基于用户的健康数据和饮食记录。

## 描述
分析用户的饮食习惯、营养摄入和健康数据，提供个性化的营养建议、膳食规划和健康饮食指导。在需要营养咨询、膳食规划或询问"我应该吃什么更健康？"时使用。

## 数据集成

### 数据源
- **饮食记录** (`data/diet/`): 日常饮食摄入数据
- **个人档案** (`data/profile.json`): 年龄、体重、活动水平
- **症状记录** (`data/symptoms/`): 食物相关症状
- **过敏信息** (`data/allergies.json`): 食物过敏和不耐受
- **药物记录** (`data/medications/`): 食物-药物相互作用
- **健康目标**: 用户的营养和健康目标

### 相关命令
- `/diet`: 记录饮食摄入
- `/allergy`: 过敏信息
- `/symptom`: 症状记录

## 核心功能

### 1. 营养分析
- **宏量营养素分析**: 蛋白质、碳水化合物、脂肪摄入
- **微量营养素分析**: 维生素、矿物质摄入
- **热量摄入分析**: 每日热量摄入与消耗对比
- **营养素平衡**: 营养摄入均衡性评估
- **膳食模式**: 进食时间、频率、模式分析

### 2. 个性化膳食规划
- **基于目标定制**: 减重、增肌、控糖、维持健康
- **考虑限制**: 过敏、不耐受、饮食偏好（素食、生酮等）
- **膳食时机**: 优化进食时间以支持健康目标
- **份量控制**: 适当的份量建议
- **实用性强**: 简单易做、成本合理的食谱

### 3. 食物-症状关联
- **食物诱因识别**: 识别引发症状的食物
- **不耐受检测**: 潜在食物不耐受
- **有益食物**: 对特定健康有益的食物
- **避免清单**: 基于过敏和相互作用的避免食物

### 4. 营养教育
- **营养知识**: 基本营养概念教育
- **阅读标签**: 如何读懂营养标签
- **健康选择**: 如何做出更健康的食物选择
- **烹饪技巧**: 健康烹饪方法

## 输出格式

### 营养分析报告
```
🥗 营养分析报告
生成时间: 2025-12-31
分析周期: 过去 7 天

📊 营养摄入概览

热量摄入:
├─ 平均每日: 1,850 kcal
├─ 目标: 2,000 kcal
├─ 差异: -150 kcal（略低于目标）
└─ 趋势: 稳定

宏量营养素:
蛋白质: ✅ 85g（17% 热量）- 达标
├─ 推荐: 60-100g
├─ 平均: 85g
└─ 评估: 优秀

碳水化合物: ⚠️ 220g（48% 热量）- 偏高
├─ 推荐: 180-220g
├─ 平均: 245g
├─ 主要来源: 米饭、面条、面包
└─ 建议: 减少精制碳水，增加复合碳水

脂肪: ✅ 65g（32% 热量）- 良好
├─ 推荐: 50-70g
├─ 饱和脂肪: 18g（略高）
├─ 不饱和脂肪: 42g
└─ 建议: 减少饱和脂肪摄入

膳食纤维: ❌ 15g - 不足
├─ 推荐: 25-35g
├─ 平均: 15g
└─ 建议: 增加蔬菜、水果、全谷物

微量营养素:
维生素C: ✅ 充足
钙: ⚠️ 略低（600mg / 推荐 800-1000mg）
维生素D: ❌ 不足（3μg / 推荐 10-20μg）
铁: ✅ 充足
钾: ✅ 充足

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🍽️ 膳食模式分析

进食时间:
├─ 早餐: 7:30 AM（80% 天数）
├─ 午餐: 12:30 PM（95% 天数）
├─ 晚餐: 7:00 PM（100% 天数）
└─ 加餐: 偶尔（20% 天数）

进食频率:
├─ 每日餐数: 平均 2.9 餐
├─ 规律性: 良好
└─ 建议加餐: 稳定血糖

膳食多样性:
├─ 蛋白质来源: 5 种（鸡、鱼、豆腐、蛋、牛肉）✅
├─ 蔬菜种类: 8 种 ✅
├─ 水果种类: 4 种（可增加）
└─ 全谷物: 2 种（可增加）

烹饪方式:
├─ 蒸/煮: 45%
├─ 炒: 35%
├─ 烤: 15%
└─ 油炸: 5% ⚠️

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎯 营养建议（优先级排序）

1. 增加膳食纤维摄入 [高优先级]
   当前: 15g/天
   目标: 25-30g/天

   行动计划:
   ├─ 早餐: 添加燕麦或全麦面包（+5g）
   ├─ 午餐: 增加蔬菜份量（+3g）
   ├─ 晚餐: 添加豆类或全谷物（+5g）
   └─ 加餐: 水果或坚果（+2g）

   具体食物建议:
   ✓ 燕麦粥配水果（早餐）
   ✓ 糙米代替白米饭
   ✓ 添加鹰嘴豆、扁豆到沙拉
   ✓ 每日2份水果
   ✓ 坚果作为健康零食

2. 减少精制碳水化合物 [高优先级]
   当前: 主要来源是白米饭、面条、白面包
   目标: 50%为复合碳水化合物

   替换建议:
   ├─ 白米饭 → 糙米、藜麦、燕麦
   ├─ 白面包 → 全麦面包
   ├─ 白面条 → 全麦面条、荞麦面
   └─ 添加: 红薯、玉米、南瓜

3. 增加钙和维生素D [中优先级]
   钙: 600mg → 目标 800-1000mg
   维生素D: 3μg → 目标 10-20μg

   行动计划:
   ├─ 乳制品: 每日2份（牛奶、酸奶）
   ├─ 深绿色蔬菜: 菠菜、羽衣甘蓝
   ├─ 富含维生素D食物:
   │  ├─ 脂肪鱼（三文鱼、沙丁鱼）
   │  ├─ 蛋黄
   │  └─ 强化食品
   └─ 考虑: 维生素D补充剂（咨询医生）

4. 减少饱和脂肪 [中优先级]
   当前: 18g/天
   目标: <15g/天

   行动计划:
   ├─ 减少红肉: 每周最多2次
   ├─ 选择瘦肉: 去皮鸡胸、瘦牛肉
   ├─ 乳制品: 选择低脂版本
   ├─ 烹饪油: 橄榄油代替黄油
   └─ 加工食品: 限制摄入

5. 增加膳食多样性 [低优先级]
   当前: 良好
   目标: 更多样

   建议:
   ├─ 尝试新蔬菜: 每周1种新蔬菜
   ├─ 蛋白质多样化: 添加虾、三文鱼
   ├─ 全谷物尝试: 大麦、藜麦、小米
   └─ 水果种类: 浆果类、猕猴桃

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

⚠️ 需要注意的食物

过敏/不耐受:
✗ 无已知过敏

食物-药物相互作用:
⚠️ 二甲双胍
   └─ 建议: 随餐服用，避免高脂餐

需要限制的食物:
□ 加工肉类（香肠、培根）
□ 高糖饮料
□ 过咸食物（血压控制）
□ 反式脂肪

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 一周膳食计划示例

周一:
├─ 早餐: 燕麦粥配香蕉+ 坚果（纤维+蛋白质）
├─ 午餐: 糙米饭+ 清蒸鱼+ 炒时蔬
├─ 加餐: 苹果+ 低脂酸奶
└─ 晚餐: 豆腐蔬菜汤+ 全麦面包

周二:
├─ 早餐: 全麦面包+ 鸡蛋+ 番茄
├─ 午餐: 藜麦沙拉+ 鸡胸肉+ 橄榄油
├─ 加餐: 胡萝卜条+ 鹰嘴豆泥
└─ 晚餐: 清蒸西兰花+ 红薯+ 瘦牛肉

周三:
├─ 早餐: 希腊酸奶+ 浆果+ 燕麦
├─ 午餐: 全麦面+ 虾仁+ 蔬菜
├─ 加餐: 橙子+ 核桃
└─ 晚餐: 扁豆汤+ 全麦面包+ 沙拉

（周四至周日类似模式...）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💡 健康饮食提示

餐盘比例（美国农业部推荐）:
├─ 50%: 蔬菜和水果
├─ 25%: 全谷物
└─ 25%: 瘦蛋白

阅读营养标签重点:
□ 关注份量
□ 限制添加糖（<10% 总热量）
□ 限制钠（<2300mg/天）
□ 增加膳食纤维
□ 避免反式脂肪

健康烹饪技巧:
□ 蒸、煮、烤优于油炸
□ 使用香草和香料代替盐
□ 控制油量
□ 保留食物营养（不过度烹饪）

购物清单原则:
✓ 多采购生鲜食品
✓ 周边购物（生鲜在外围）
✓ 阅读标签
✓ 避免饥饿时购物
✓ 坚持清单

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📈 营养评分

总体评分: 72/100

分项评分:
蛋白质摄入: 85/100 ✅
碳水质量: 60/100 ⚠️
脂肪质量: 70/100 ✅
纤维摄入: 50/100 ❌
微量营养素: 65/100 ⚠️
膳食多样性: 80/100 ✅
进食模式: 75/100 ✅

进步空间:
├─ 增加膳食纤维（优先）
├─ 改善碳水质量
├─ 补充微量营养素
└─ 减少饱和脂肪

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎯 下周目标

1. 膳食纤维达到 20g/天
2. 全谷物替代 50% 精制谷物
3. 每日 5 份蔬菜水果
4. 尝试 2 种新健康食谱

成功指标:
✓ 记录饮食
✓ 达到纤维目标 5/7 天
✓ 尝试新食谱
✓ 感觉更饱腹、更有能量

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
由个人健康信息系统生成
营养顾问
下周同一时间复查
```

## 技术实现

### 营养分析算法
```python
def analyze_nutrition(diet_records, profile):
    """分析营养摄入"""
    analysis = {
        "calories": calculate_calories(diet_records),
        "macronutrients": analyze_macros(diet_records),
        "micronutrients": analyze_micros(diet_records),
        "meal_patterns": analyze_patterns(diet_records),
        "food_variety": calculate_variety(diet_records)
    }

    # 与目标对比
    targets = calculate_targets(profile)
    assessment = compare_to_targets(analysis, targets)

    # 生成建议
    recommendations = generate_recommendations(assessment, profile)

    return {
        "analysis": analysis,
        "assessment": assessment,
        "recommendations": recommendations,
        "score": calculate_nutrition_score(assessment)
    }
```

## 用户交互示例

### 示例 1: 营养评估
**用户**: "我的饮食营养怎么样？"
**技能**: 分析饮食记录，提供全面营养评估报告

### 示例 2: 膳食规划
**用户**: "帮我制定一个健康的一周饮食计划"
**技能**: 基于健康目标、过敏、偏好创建个性化膳食计划

### 示例 3: 饮食建议
**用户**: "我想增加蛋白质摄入，应该吃什么？"
**技能**: 提供富含蛋白质的食物选择和膳食建议

### 示例 4: 症状关联
**用户**: "我每次吃乳制品都觉得不舒服"
**技能**: 分析饮食与症状关联，识别潜在乳糖不耐受

## 允许的工具
- `Read`: 读取饮食、过敏、症状数据
- `Write`: 生成营养报告和膳食计划
- `Grep`: 搜索特定食物或营养素

## 安全与免责
```
⚠️ 营养建议免责声明
此营养分析基于您提供的数据，仅供参考。
不替代注册营养师或医生的专业建议。

如有以下情况，请咨询专业人士：
- 特殊医疗状况
- 服用药物
- 孕期或哺乳期
- 重大饮食改变
```

## 测试清单
- [ ] 测试营养分析准确性
- [ ] 测试膳食计划生成
- [ ] 验证过敏和相互作用检查
- [ ] 测试食物-症状关联
- [ ] 验证建议可实施性
- [ ] 测试不同饮食偏好（素食、生酮等）

## 相关技能
- `health-trend-analyzer`: 营养趋势分析
- `symptom-pattern-analyzer`: 食物-症状关联
- `wellness-coach`: 整体健康饮食指导
