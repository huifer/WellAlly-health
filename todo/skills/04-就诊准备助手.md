# 就诊准备助手技能设计

## 概述
**技能名称**: `visit-prep`
**目的**: 自动准备全面的医疗就诊摘要，将所有相关健康信息整合成医生可用的格式。

## 描述
通过整合症状、药物、生命体征、化验问题和综合信息，准备全面的医疗就诊摘要，供医疗服务提供者使用。在准备医生就诊、专科咨询或询问"我去看医生应该带什么？"时使用。

## 数据集成

### 数据源
- **所有健康数据源** - 全面数据聚合
- **个人档案** (`data/profile.json`): 基本患者信息
- **药物记录** (`data/medications/`): 当前和过去的药物
- **过敏信息** (`data/allergies.json`): 关键过敏信息
- **症状记录** (`data/symptoms/`): 近期症状历史
- **手术记录** (`data/手术记录/`): 手术历史
- **辐射记录** (`data/radiation-records.json`): 影像历史
- **出院小结** (`data/出院小结/`): 住院情况
- **化验报告** (`data/medical-reports/`): 近期检查结果

### 相关命令
- 所有健康命令 - 聚合整个系统的数据
- `/save-report`: 化验结果分析
- `/consult`: 专科咨询

## 核心功能

### 1. 全面数据聚合
- **时间线生成**: 按时间顺序的健康事件时间线
- **当前药物**: 当前药物清单及剂量和时间表
- **过敏摘要**: 所有过敏及其严重程度等级
- **症状历史**: 近期症状及其频率和严重程度
- **生命体征**: 随时间的体重、BMI 趋势
- **化验结果**: 近期检查结果及趋势
- **手术历史**: 所有手术及其日期和结果
- **住院情况**: 出院摘要和诊断

### 2. 就诊类型定制
- **初级保健就诊**: 一般健康概览
- **专科就诊**: 针对特定专科定制
  - 心内科: 关注血压、心脏症状、心脏药物
  - 内分泌科: 关注激素、糖尿病、甲状腺
  - 神经科: 关注神经系统症状、影像
  - 消化科: 关注消化症状、饮食
  - 皮肤科: 关注皮肤症状、药物
  - 精神科: 关注情绪、心理健康药物
  - 骨科: 关注关节/肌肉症状、手术
- **急诊就诊**: 仅关键信息
- **年度体检**: 完整健康摘要

### 3. 问题准备
- **症状问题**: 关于当前症状的问题
- **药物问题**: 关于药物和副作用的问题
- **化验结果问题**: 关于化验/影像结果的问题
- **预防保健问题**: 疫苗接种、筛查
- **生活方式问题**: 饮食、运动、睡眠
- **随访问题**: 前次就诊的问题

## 输出格式

### 医生摘要（初级保健示例）
```
医疗就诊摘要
生成时间: 2025-12-31
患者: 张三 | 年龄: 45 | 性别: 男

📋 就诊类型: 初级保健 / 年度体检

👤 患者档案
├─ 年龄: 45 岁
├─ 身高: 175 cm
├─ 体重: 78 kg（BMI: 25.5 - 超重）
├─ 血型: A+（如果已知）
└─ 上次就诊: 2025-06-15（6 个月前）

💊 当前药物（3 种）
1. 赖诺普利 10mg - 每日（早晨）
   ├─ 用途: 降压
   ├─ 开始: 2025-11-15（6 周前）
   ├─ 开方医生: 李医生（心内科）
   └─ 副作用: 未报告

2. 二甲双胍 500mg - 每日两次，随餐
   ├─ 用途: 降糖
   ├─ 开始: 2025-03-10
   └─ 副作用: 空腹服用时恶心

3. 阿司匹林 81mg - 每日
   ├─ 用途: 心脏健康
   └─ 开始: 2025-01-15

⚠️ 过敏（2 种已知）
1. 青霉素 - 严重（过敏性休克）
2. 磺胺类药物 - 中度（皮疹）

🩺 手术历史
1. 阑尾切除术 - 2015-03-20
   ├─ 医院: 市第一医院
   └─ 结果: 常规，无并发症

📊 生命体征趋势（过去 6 个月）
├─ 体重: 78 kg → 76 kg（-2 kg，-2.5%）
├─ BMI: 25.5 → 24.8（改善）
├─ 血压: （家庭监测）
│  ├─ 早晨平均: 135/85 mmHg
│  ├─ 晚间平均: 128/82 mmHg
│  └─ 趋势: 自开始赖诺普利后改善
└─ 上次测量: 2025-12-28

🔬 近期化验结果（过去 3 个月）
血常规 - 2025-11-20
├─ 血红蛋白: 142 g/L（正常）
├─ 白细胞: 6.5 × 10^9/L（正常）
└─ 血小板: 250 × 10^9/L（正常）

代谢板 - 2025-11-20
├─ 葡萄糖: 5.83 mmol/L（略高）
├─ 肌酐: 88.4 μmol/L（正常）
├─ eGFR: 92 mL/min（正常）
└─ 钾: 4.2 mmol/L（正常）

血脂 - 2025-11-20
├─ 总胆固醇: 5.46 mmol/L（边缘高）
├─ LDL: 3.49 mmol/L（高）
└─ 甘油三酯: 1.69 mmol/L（边缘高）

糖化血红蛋白 - 2025-09-15
└─ 6.8%（升高 - 糖尿病监测）

😊 症状历史（上次就诊后 - 6 个月）
最频繁症状:
├─ 头痛: 15 次（趋势下降）
│  ├─ 平均严重程度: 6/10
│  └─ 最近: 2025-12-28
│
├─ 恶心: 8 次
│  └─ 关联: 空腹服用二甲双胍
│
└─ 疲劳: 12 次
   └─ 关联: 睡眠差

❓ 讨论问题
症状问题:
1. 头痛仍每月 2-3 次
   └─ 应考虑预防药物吗？

2. 服用二甲双胍偶有恶心
   └─ 缓释剂型会有帮助吗？

3. 开始赖诺普利后能量水平仍低
   └─ 这与药物有关吗？

化验问题:
4. 糖化血红蛋白趋势和糖尿病管理目标
5. LDL 胆固醇 - 生活方式 vs 药物治疗
6. 赖诺普利和二甲双胍的肾功能监测

📯 摘要和优先事项
当前健康状况: 总体稳定，改善

需处理的问题:
1. 血压管理（中度控制）
2. 糖尿病管理（糖化血红蛋白 6.8%）
3. 胆固醇管理（LDL 升高）
4. 体重管理（BMI 25.5）
5. 偶发头痛

---
由个人健康信息系统生成
日期: 2025-12-31
```

## 用户交互示例

### 示例 1: 初级保健就诊
**用户**: "我下周有医生预约。能帮我准备吗？"
**技能**: "我很乐意帮助！让我收集您的健康信息并准备摘要。这是什么类型的预约？"（生成综合摘要）

### 示例 2: 专科就诊
**用户**: "我第一次看心脏科医生。应该带什么？"
**技能**: 生成心内科重点摘要，强调心脏症状、血压日志和心脏药物

### 示例 3: 问题准备
**用户**: "我应该问医生什么关于我的化验结果？"
**技能**: 审查化验结果，生成关于异常发现和趋势的具体问题

## 测试清单
- [ ] 测试完整数据集
- [ ] 测试最少数据
- [ ] 测试每种就诊类型
- [ ] 验证包含所有数据源
- [ ] 测试问题生成
- [ ] 测试优先级逻辑
- [ ] 验证输出格式
- [ ] 测试急诊摘要格式
- [ ] 验证专科定制

## 相关技能
- `health-trend-analyzer`: 为就诊提供趋势分析
- `medication-advisor`: 就诊的药物问题
- `symptom-pattern-analyzer`: 就诊的症状分析
- `emergency-card`: 关键急诊信息
